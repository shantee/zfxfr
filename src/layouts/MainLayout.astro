---
import Base from "./BaseLayout.astro";
import NavBar from "../components/NavBar.astro";
import Banner from "../components/HeaderP5.astro";

import YukinaConfig from "../../yukina.config";
import Footer from "../components/Footer.astro";
// import SideBar from "../components/SideBar.astro"; // si besoin

export interface Props {
  title?: string;
  subTitle?: string;
  bannerImage?: string;
  image?: string;
  slug?: string;
  bannerHeight?: string;

  // SEO (optionnels)
  seoTitle?: string;
  seoDescription?: string;
  seoImage?: string;
  ogType?: "website" | "article";
  canonical?: string;
  noindex?: boolean;
}

const {
  title,
  subTitle,
  bannerImage,
  image,
  slug,
  bannerHeight,

  seoTitle = title,
  seoDescription = subTitle,
  seoImage = image ?? bannerImage,
  ogType = "website",
  canonical,
  noindex = false,
} = Astro.props;
---

<Base
  title={seoTitle}
  description={seoDescription}
  image={seoImage}
  type={ogType}
  canonical={canonical}
  noindex={noindex}
>
  <NavBar />

  {YukinaConfig.bannerStyle == "LOOP" && (
    <div style={`--banner-height:${bannerHeight ?? "40svh"}`}>
      <Banner
        title={title}
        subTitle={subTitle}
        bannerImage={bannerImage}
        slug={slug}
      />
    </div>
  )}

  <div class="main-container my-10">
    <div class="flex flex-row items-start xl:space-x-4">
      <div class="space-y-8 min-w-0">
        <main class="content onload-animation">
          <slot />
        </main>
        <Footer />
      </div>
    </div>
  </div>
</Base>

<style>
  /* Centre le bloc global sur TOUTES les largeurs + borne la largeur du site */
  .main-container {
    width: 100%;
    max-width: var(--page-width-xl);
    margin-left: auto;
    margin-right: auto;
    padding-left: 16px;
    padding-right: 16px;
    margin-bottom: 0px;
  }

  /* Centre l'enfant du flex (là où il y a <main> + <Footer>) */
  .flex.flex-row.items-start {
    justify-content: center;
  }

  .transition-leaving {
    margin-left: auto;
    margin-right: auto;
  }

  /* IMPORTANT : on neutralise l’ancienne largeur liée à la sidebar */
  .content {
    width: 100% !important;
    max-width: none !important;
  }
</style>
